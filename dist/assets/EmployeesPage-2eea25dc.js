var z=Object.defineProperty;var B=(s,t,n)=>t in s?z(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var h=(s,t,n)=>(B(s,typeof t!="symbol"?t+"":t,n),n);import{e as k,f as u,g,d as f,j as e,B as j,a as y,G as A,n as p,h as C,A as w,S as P,F as $,c as N}from"./index-8389bfe9.js";import{q as U,u as S,I as q,E as b,a as G,S as E,b as R,c as V,d as T,e as W,f as H,g as L,F as M}from"./index-d0ae40ee.js";import{S as K}from"./Seo-552cc6e6.js";import{u as F,T as v,I as Q}from"./use-form-8ee320fd.js";import"./Paper-f69f1702.js";const X="b",J="c",Y={row:X,employees:J};class D{constructor(t){h(this,"id");h(this,"name");h(this,"createdAt");h(this,"updatedAt");this.id=t.id,this.name=t.name,this.createdAt=k.formatDate(t.createdAt),this.updatedAt=k.formatDate(t.updatedAt)}}const x={getEmployeesList:s=>u.Get(`${g.employees}?${U.stringify(s)}`,{transformData:t=>({...t,data:t.data.map(n=>new D(n))})}),getEmployees:s=>u.Get(`${g.employees}/${s}`,{transformData:t=>new D(t)}),createEmployees:s=>u.Post(g.employees,s),updateEmployees:(s,t)=>u.Put(`${g.employees}/${s}`,t),deleteEmployees:s=>u.Delete(`${g.employees}/${s}`)},Z=({onSuccess:s})=>{const[t,{open:n,close:d}]=S(!1),{loading:r,send:i}=f(l=>x.createEmployees(l),{immediate:!1}),o=F({initialValues:{name:""},validate:{name:l=>l.length?null:"name not empty"}}),c=l=>{o.onSubmit(a=>{i(a).then(()=>{p.show({message:"Create success!",color:"green"}),s()}).catch(m=>{console.log("error",m),p.show({message:C(m,"message","Something went wrong, please try again later!"),color:"red"})}).finally(()=>{d(),o.reset()})})(l)};return e.jsxs(j,{children:[e.jsx(y,{fullWidth:!0,leftIcon:e.jsx(q,{}),onClick:n,children:"Create"}),e.jsx(b,{opened:t,onClose:()=>{d(),o.reset()},title:"Create new Employees",children:e.jsx(j,{mx:"auto",w:"100%",children:e.jsxs("form",{onSubmit:c,children:[e.jsx(v,{withAsterisk:!0,label:"Name",placeholder:"enter name",...o.getInputProps("name")}),e.jsx(A,{position:"right",mt:"md",children:e.jsx(y,{disabled:r,type:"submit",children:"Submit"})})]})})})]})},_=[{label:"Name",key:"name"},{label:"Create At",key:"createdAt"},{label:"Update At",key:"updatedAt"}],ee=({data:s})=>{const[t,{open:n,close:d}]=S(!1),{loading:r,data:i}=f(()=>x.getEmployees(s==null?void 0:s.id),{immediate:!0});return e.jsxs(e.Fragment,{children:[e.jsx(w,{color:"green",onClick:n,children:e.jsx(G,{size:16})}),e.jsx(b,{opened:t,onClose:d,title:`Detail [${s==null?void 0:s.name}]`,children:r?e.jsxs(P,{w:"100%",children:[e.jsx(E,{height:12,mt:6,width:"70%",radius:"xl"}),e.jsx(E,{height:12,radius:"xl"}),e.jsx(E,{height:12,mt:6,radius:"xl"})]}):e.jsx(P,{w:"100%",children:_.map(o=>e.jsxs($,{justify:"space-between",children:[e.jsxs("span",{style:{fontWeight:"bold"},children:[o==null?void 0:o.label,":"]}),e.jsx("span",{children:i==null?void 0:i[o==null?void 0:o.key]})]},o.label))})})]})},se=({onSuccess:s,data:t})=>{const[n,{open:d,close:r}]=S(!1),{loading:i,send:o}=f(m=>x.updateEmployees(t.id,m),{immediate:!1}),c=F({initialValues:{name:""},validate:{name:m=>m.length?null:"name not empty"}}),l=m=>{c.onSubmit(O=>{o(O).then(()=>{p.show({message:"Update success!",color:"green"}),s()}).catch(I=>{console.log("error",I),p.show({message:C(I,"message","Something went wrong, please try again later!"),color:"red"})}).finally(()=>{r(),c.reset()})})(m)},a=()=>{c.setValues({name:t.name}),d()};return e.jsxs(j,{children:[e.jsx(w,{color:"blue",onClick:a,children:e.jsx(R,{size:16})}),e.jsx(b,{opened:n,onClose:()=>{r(),c.reset()},title:`Update employee ${t.name}`,children:e.jsx(j,{mx:"auto",w:"100%",children:e.jsxs("form",{onSubmit:l,children:[e.jsx(v,{withAsterisk:!0,label:"Name",placeholder:"enter name",...c.getInputProps("name")}),e.jsx(A,{position:"right",mt:"md",children:e.jsx(y,{disabled:i,type:"submit",children:"Submit"})})]})})})]})},te=({data:s,onSuccess:t})=>{const[n,{open:d,close:r}]=S(!1),{loading:i,send:o}=f(l=>x.deleteEmployees(l),{immediate:!1}),c=()=>{o(s==null?void 0:s.id).then(()=>{r(),t(),p.show({message:"Delete success!",color:"green"})}).catch(l=>{p.show({message:C(l,"message","Something went wrong, please try again later!"),color:"red"})})};return e.jsxs(e.Fragment,{children:[e.jsx(w,{color:"red",onClick:d,children:e.jsx(V,{size:16})}),e.jsx(b,{opened:n,onClose:r,title:`Delete ${s==null?void 0:s.name}`,children:e.jsx(y,{disabled:i,onClick:c,color:"red",children:"OK"})})]})},ne=N();function oe(s){const[t,n]=T(""),{loading:d,data:r,page:[i,o],total:c,refresh:l}=W((a,m)=>x.getEmployeesList({page:a,pageSize:m,q:t}),{watchingStates:[t],debounce:1e3,initialPage:1,initialPageSize:10,total:a=>a.total,data:a=>a.data,initialData:{page:1,pageSize:10,total:0,data:[]}});return e.jsxs("div",{className:ne(Y.employees),children:["Employees",e.jsx(K,{title:"Employees",description:"Page generate for Employees",type:"preview"}),e.jsx("h1",{children:"Employees"}),e.jsxs($,{gap:10,sx:{paddingBottom:12,alignItems:"center",justifyContent:"space-between"},children:[e.jsx(Q,{icon:e.jsx(H,{}),rightSection:t&&e.jsx(w,{onClick:()=>n(""),children:e.jsx(L,{size:16})}),placeholder:"Search ...",radius:"md",size:"sm",value:t,onChange:n}),e.jsx(Z,{onSuccess:()=>l(1)})]}),e.jsx(M,{withBorder:!0,borderRadius:"md",withColumnBorders:!0,striped:!0,minHeight:150,loaderVariant:"oval",page:i,onPageChange:a=>o(a),recordsPerPage:10,totalRecords:c,highlightOnHover:!0,fetching:d,records:r,columns:[{accessor:"index",title:"#",textAlignment:"right",width:40,render:a=>r.indexOf(a)+1},{accessor:"name"},{accessor:"createdAt"},{accessor:"updatedAt"},{accessor:"Actions",textAlignment:"right",render:a=>e.jsxs(A,{spacing:4,position:"right",noWrap:!0,children:[e.jsx(ee,{data:a}),e.jsx(se,{data:a,onSuccess:()=>l(1)}),e.jsx(te,{data:a,onSuccess:()=>l(1)})]})}]})]})}const me=oe;export{me as Component,oe as EmployeesPage};
